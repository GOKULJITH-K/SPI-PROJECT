##  Code Coverage – APB-SPI Core

This folder contains the **code coverage flow** for the APB-SPI Core using **Synopsys VCS**.  
Coverage ensures that the testbench exercises **all RTL modules** thoroughly and helps identify untested code paths.

---

##  What is Code Coverage?

Code coverage measures how much of the design is exercised during simulation:

- **Line coverage** → Did each RTL line execute?  
- **Branch coverage** → Were all `if/else` and `case` branches taken?  
- **Condition coverage** → Were all boolean sub-expressions evaluated both true and false?  
- **Toggle coverage** → Did each signal toggle `0→1` and `1→0`?  
- **FSM coverage** → Were all states and transitions of finite state machines visited?  

 **Branch vs Condition**:  
- *Branch coverage* only checks which branch of an `if/else` was taken.  
- *Condition coverage* goes deeper: for `if (a && b)`, it checks both `a` and `b` toggled through true/false values, not just the combined outcome.

---

##  Toolchain

- **Simulator:** Synopsys VCS  
- **Report generation:** URG (Unified Report Generator)  
- **Interactive exploration:** Verdi  

---

##  Makefile

```makefile
# RTL and TB paths (example for baud generator)
RTL = ../rtl/spi_baud_generator.v
TB  = ../tb/spi_baud_generator_tb.v

FSDB_PATH=/home/cad/eda/SYNOPSYS/VERDI_2022/verdi/T-2022.06-SP1/share/PLI/VCS/LINUX64

help:
	@echo ===========================================================================================================================
	@echo " USAGE   	--  make <target>"
	@echo " clean   	=>  clean logs and intermediate files."
	@echo " run     	=>  compile + simulate with coverage enabled."
	@echo " report  	=>  generate HTML/text coverage reports with URG."
	@echo " verdi   	=>  open coverage results in Verdi GUI."
	@echo ===========================================================================================================================

clean:
	rm -rf csrc .fsdb novas_dump.log simv* simv1.daidir ucli.key verdi* novas.* cm.log vdCov* *.vdb *.urg coverage_report
	clear

report:
  vcs $(RTL) $(TB) -cm line+cond+branch+tgl+fsm
	./simv -cm line+cond+branch+tgl+fsm
	urg -dir simv.vdb 

verdi:
  vcs $(RTL) $(TB) -cm line+cond+branch+tgl+fsm
	./simv -cm line+cond+branch+tgl+fsm
	urg -dir simv.vdb 
	verdi -cov -covdir simv.vdb

````

---

##  How to Run

1. **Clean previous runs**

   ```bash
   make clean
   ```
2. **Compile & simulate with coverage enabled**

   ```bash
   make run
   ```

   This produces `simv.vdb/` (coverage database).
3. **Generate human-readable reports**

   ```bash
   make report
   ```

   HTML report appears under `urgReport/urgReport.html`.
4. **Open interactive coverage in Verdi**

   ```bash
   make verdi
   ```

---

##  Outputs

* `simv.vdb/` → Coverage database (auto-generated by VCS).
* `urgReport/` → Reports generated by URG.
  
---

##  Coverage Results by Module

Update this table with your actual URG results after each run:

| Module                | Line | Branch | Condition | Toggle | FSM  |
| --------------------- | ---- | ------ | --------- | ------ | ---- |
| `spi_baud_generator`  | 100%  | 100%    | 77.78%       | 95.45%    | - |
| `spi_shift_reg`       | 92%  | 85%    | 82%       | 90%    | 95%  |
| `spi_slave_select`    | 98%  | 96%    | 94%       | 93%    | 100% |
| `spi_slave_interface` | 93%  | 87%    | 85%       | 89%    | 92%  |

---

##  Individual Module Reports

Click to view module-specific coverage reports (paths generated by URG):

* [spi_baud_generator Coverage](./coverage_report/urgReport/files/rtl_spi_baud_generator_v.html)
* [spi_shift_reg Coverage](./coverage_report/urgReport/files/rtl_spi_shift_reg_v.html)
* [spi_slave_select Coverage](./coverage_report/urgReport/files/rtl_spi_slave_select_v.html)
* [spi_slave_interface Coverage](./coverage_report/urgReport/files/rtl_spi_slave_interface_v.html)
* [top_mod Coverage](./coverage_report/urgReport/files/rtl_top_mod_v.html)

---

##  How to Interpret Coverage Reports

* **Green highlight** = Covered.
* **Red highlight** = Uncovered → add new testcases.
* **Yellow highlight** = Partially covered.

---

##  Summary

* Run `make run` → compile + simulate with coverage enabled.
* Run `make report` → generate HTML/text coverage reports.
* Run `make verdi` → analyze coverage interactively.
* View [coverage_report/urgReport.html](./coverage_report/urgReport.html) for summary, or per-module links for details.

---
